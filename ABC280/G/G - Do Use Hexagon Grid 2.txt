G - Do Use Hexagon Grid 2
×
コンテスト開始
デンソークリエイトプログラミングコンテスト2022 Winter(AtCoder Beginner Contest 280)が開始されました。
閉じる
×
コンテスト終了
デンソークリエイトプログラミングコンテスト2022 Winter(AtCoder Beginner Contest 280)は終了しました。
閉じる
デンソークリエイトプログラミングコンテスト2022 Winter(AtCoder Beginner Contest 280)
日本語
日本語
English
新規登録
ログイン
コンテスト時間:
2022-12-03(土) 21:00
~
2022-12-03(土) 22:40
(100分)
AtCoderホームへ戻る
トップ
問題
質問
提出結果
すべての提出
順位表
バーチャル順位表
解説
G - Do Use Hexagon Grid 2
解説
/
実行時間制限: 3 sec / メモリ制限: 1024 MB
配点 :
600
600
6
0
0
点
問題文
以下のような、無限に広い六角形のグリッドがあります。
六角形のマスは
2
2
2
つの整数
i
,
j
i,j
i
,
j
を用いて
(
i
,
j
)
(i,j)
(
i
,
j
)
と表されます。
マス
(
i
,
j
)
(i,j)
(
i
,
j
)
は以下の
6
6
6
つのマスと辺で隣接しています。
(
i
−
1
,
j
−
1
)
(i-1,j-1)
(
i
−
1
,
j
−
1
)
(
i
−
1
,
j
)
(i-1,j)
(
i
−
1
,
j
)
(
i
,
j
−
1
)
(i,j-1)
(
i
,
j
−
1
)
(
i
,
j
+
1
)
(i,j+1)
(
i
,
j
+
1
)
(
i
+
1
,
j
)
(i+1,j)
(
i
+
1
,
j
)
(
i
+
1
,
j
+
1
)
(i+1,j+1)
(
i
+
1
,
j
+
1
)
2
2
2
つのマス
X
,
Y
X,Y
X
,
Y
の距離を、辺で隣接しているマスをたどってマス
X
X
X
からマス
Y
Y
Y
まで移動するときの、移動回数の最小値と定めます。
例えばマス
(
0
,
0
)
(0,0)
(
0
,
0
)
とマス
(
1
,
1
)
(1,1)
(
1
,
1
)
の距離は
1
1
1
、マス
(
2
,
1
)
(2,1)
(
2
,
1
)
とマス
(
−
1
,
−
1
)
(-1,-1)
(
−
1
,
−
1
)
の距離は
3
3
3
です。
N
N
N
個のマス
(
X
1
,
Y
1
)
,
…
,
(
X
N
,
Y
N
)
(X_1,Y_1),ldots,(X_N,Y_N)
(
X
1
​
,
Y
1
​
)
,
…
,
(
X
N
​
,
Y
N
​
)
が与えられます。
この
N
N
N
マスの中から
1
1
1
つ以上のマスを選ぶ方法のうち、選んだマスのうちどの
2
2
2
マスの距離も
D
D
D
以下になるようなものは何通りありますか？
998244353
998244353
9
9
8
2
4
4
3
5
3
で割ったあまりを求めてください。
制約
1
≤
N
≤
300
1 leq N leq 300
1
≤
N
≤
3
0
0
−
1
0
9
≤
X
i
,
Y
i
≤
1
0
9
-10^9leq X_i,Y_i leq 10^9
−
1
0
9
≤
X
i
​
,
Y
i
​
≤
1
0
9
1
≤
D
≤
1
0
10
1leq D leq 10^{10}
1
≤
D
≤
1
0
1
0
(
X
i
,
Y
i
)
(X_i,Y_i)
(
X
i
​
,
Y
i
​
)
は相異なる
入力は全て整数である
入力
入力は以下の形式で標準入力から与えられる。
N
N
N
D
D
D
X
1
X_1
X
1
​
Y
1
Y_1
Y
1
​
⋮
vdots
⋮
X
N
X_N
X
N
​
Y
N
Y_N
Y
N
​
出力
答えを出力せよ。
入力例 1
Copy
Copy
3 1
0 0
0 1
1 0
出力例 1
Copy
Copy
5
選ぶマスの集合として考えられるのは
{
(
0
,
0
)
}
,
{
(
0
,
1
)
}
,
{
(
1
,
0
)
}
,
{
(
0
,
0
)
,
(
0
,
1
)
}
,
{
(
0
,
0
)
,
(
1
,
0
)
}
{(0,0)},{(0,1)},{(1,0)},{(0,0),(0,1)},{(0,0),(1,0)}
{
(
0
,
0
)
}
,
{
(
0
,
1
)
}
,
{
(
1
,
0
)
}
,
{
(
0
,
0
)
,
(
0
,
1
)
}
,
{
(
0
,
0
)
,
(
1
,
0
)
}
の
5
5
5
通りです。
入力例 2
Copy
Copy
9 1
0 0
0 1
0 2
1 0
1 1
1 2
2 0
2 1
2 2
出力例 2
Copy
Copy
33
入力例 3
Copy
Copy
5 10000000000
314159265 358979323
846264338 -327950288
-419716939 937510582
-97494459 -230781640
628620899 862803482
出力例 3
Copy
Copy
31
Score :
600
600
6
0
0
points
Problem Statement
We have an infinite hexagonal grid shown below.
A hexagonal cell is represented as
(
i
,
j
)
(i,j)
(
i
,
j
)
with two integers
i
i
i
and
j
j
j
.
Cell
(
i
,
j
)
(i,j)
(
i
,
j
)
is adjacent to the following six cells:
(
i
−
1
,
j
−
1
)
(i-1,j-1)
(
i
−
1
,
j
−
1
)
(
i
−
1
,
j
)
(i-1,j)
(
i
−
1
,
j
)
(
i
,
j
−
1
)
(i,j-1)
(
i
,
j
−
1
)
(
i
,
j
+
1
)
(i,j+1)
(
i
,
j
+
1
)
(
i
+
1
,
j
)
(i+1,j)
(
i
+
1
,
j
)
(
i
+
1
,
j
+
1
)
(i+1,j+1)
(
i
+
1
,
j
+
1
)
Let us define the distance between two cells
X
X
X
and
Y
Y
Y
by the minimum number of moves required to travel from cell
X
X
X
to cell
Y
Y
Y
by repeatedly moving to an adjacent cell.
For example, the distance between cells
(
0
,
0
)
(0,0)
(
0
,
0
)
and
(
1
,
1
)
(1,1)
(
1
,
1
)
is
1
1
1
, and the distance between cells
(
2
,
1
)
(2,1)
(
2
,
1
)
and
(
−
1
,
−
1
)
(-1,-1)
(
−
1
,
−
1
)
is
3
3
3
.
You are given
N
N
N
cells
(
X
1
,
Y
1
)
,
…
,
(
X
N
,
Y
N
)
(X_1,Y_1),ldots,(X_N,Y_N)
(
X
1
​
,
Y
1
​
)
,
…
,
(
X
N
​
,
Y
N
​
)
.
How many ways are there to choose one or more from these
N
N
N
cells so that the distance between any two of the chosen cells is at most
D
D
D
?
Find the count modulo
998244353
998244353
9
9
8
2
4
4
3
5
3
.
Constraints
1
≤
N
≤
300
1 leq N leq 300
1
≤
N
≤
3
0
0
−
1
0
9
≤
X
i
,
Y
i
≤
1
0
9
-10^9leq X_i,Y_i leq 10^9
−
1
0
9
≤
X
i
​
,
Y
i
​
≤
1
0
9
1
≤
D
≤
1
0
10
1leq D leq 10^{10}
1
≤
D
≤
1
0
1
0
(
X
i
,
Y
i
)
(X_i,Y_i)
(
X
i
​
,
Y
i
​
)
are pairwise distinct.
All values in the input are integers.
Input
The input is given from Standard Input in the following format:
N
N
N
D
D
D
X
1
X_1
X
1
​
Y
1
Y_1
Y
1
​
⋮
vdots
⋮
X
N
X_N
X
N
​
Y
N
Y_N
Y
N
​
Output
Print the answer.
Sample Input 1
Copy
Copy
3 1
0 0
0 1
1 0
Sample Output 1
Copy
Copy
5
There are five possible sets of the chosen cells:
{
(
0
,
0
)
}
,
{
(
0
,
1
)
}
,
{
(
1
,
0
)
}
,
{
(
0
,
0
)
,
(
0
,
1
)
}
{(0,0)},{(0,1)},{(1,0)},{(0,0),(0,1)}
{
(
0
,
0
)
}
,
{
(
0
,
1
)
}
,
{
(
1
,
0
)
}
,
{
(
0
,
0
)
,
(
0
,
1
)
}
, and
{
(
0
,
0
)
,
(
1
,
0
)
}
{(0,0),(1,0)}
{
(
0
,
0
)
,
(
1
,
0
)
}
.
Sample Input 2
Copy
Copy
9 1
0 0
0 1
0 2
1 0
1 1
1 2
2 0
2 1
2 2
Sample Output 2
Copy
Copy
33
Sample Input 3
Copy
Copy
5 10000000000
314159265 358979323
846264338 -327950288
-419716939 937510582
-97494459 -230781640
628620899 862803482
Sample Output 3
Copy
Copy
31
Facebook
Twitter
Hatena
共有
ルール
用語集
利用規約
プライバシーポリシー
個人情報保護方針
企業情報
よくある質問
お問い合わせ
資料請求
Copyright Since 2012 ©
AtCoder Inc.
All rights reserved.
2024-03-19 (火)
18:07:28 +09:00
ページトップ
✓
共有ありがとう
AddToAny
もっと