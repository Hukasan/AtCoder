F - Pay or Receive
×
コンテスト開始
デンソークリエイトプログラミングコンテスト2022 Winter(AtCoder Beginner Contest 280)が開始されました。
閉じる
×
コンテスト終了
デンソークリエイトプログラミングコンテスト2022 Winter(AtCoder Beginner Contest 280)は終了しました。
閉じる
デンソークリエイトプログラミングコンテスト2022 Winter(AtCoder Beginner Contest 280)
日本語
日本語
English
新規登録
ログイン
コンテスト時間:
2022-12-03(土) 21:00
~
2022-12-03(土) 22:40
(100分)
AtCoderホームへ戻る
トップ
問題
質問
提出結果
すべての提出
順位表
バーチャル順位表
解説
F - Pay or Receive
解説
/
実行時間制限: 2 sec / メモリ制限: 1024 MB
配点 :
500
500
5
0
0
点
問題文
1
,
…
,
N
1,ldots,N
1
,
…
,
N
の番号がついた
N
N
N
個の街と、
1
,
…
,
M
1,ldots,M
1
,
…
,
M
の番号がついた
M
M
M
本の道路があります。
道路
i
i
i
は街
A
i
A_i
A
i
​
と
B
i
B_i
B
i
​
を結んでいます。道路を通行すると、所持している
ポイント
が次の通り増減します。
道路
i
i
i
を使って、街
A
i
A_i
A
i
​
から街
B
i
B_i
B
i
​
に移動するときにはポイントが
C
i
C_i
C
i
​
増加し、街
B
i
B_i
B
i
​
から街
A
i
A_i
A
i
​
に移動するときにはポイントが
C
i
C_i
C
i
​
減少する。
所持しているポイントは負にもなりえます。
次の
Q
Q
Q
個の質問に答えてください。
所持しているポイントが
0
0
0
である状態で街
X
i
X_i
X
i
​
から移動を始めたとき、街
Y
i
Y_i
Y
i
​
にいる状態で所持しているポイントの最大値を出力せよ。
ただし、街
X
i
X_i
X
i
​
から街
Y
i
Y_i
Y
i
​
に到達できないときは
nan
、街
Y
i
Y_i
Y
i
​
にいる状態で所持しているポイントをいくらでも増やせるときは
inf
を代わりに出力せよ。
制約
2
≤
N
≤
1
0
5
2leq N leq 10^5
2
≤
N
≤
1
0
5
0
≤
M
≤
1
0
5
0leq M leq 10^5
0
≤
M
≤
1
0
5
1
≤
Q
≤
1
0
5
1leq Q leq 10^5
1
≤
Q
≤
1
0
5
1
≤
A
i
,
B
i
,
X
i
,
Y
i
≤
N
1leq A_i,B_i,X_i,Y_i leq N
1
≤
A
i
​
,
B
i
​
,
X
i
​
,
Y
i
​
≤
N
0
≤
C
i
≤
1
0
9
0leq C_i leq 10^9
0
≤
C
i
​
≤
1
0
9
入力は全て整数である
入力
入力は以下の形式で標準入力から与えられる。
N
N
N
M
M
M
Q
Q
Q
A
1
A_1
A
1
​
B
1
B_1
B
1
​
C
1
C_1
C
1
​
⋮
vdots
⋮
A
M
A_M
A
M
​
B
M
B_M
B
M
​
C
M
C_M
C
M
​
X
1
X_1
X
1
​
Y
1
Y_1
Y
1
​
⋮
vdots
⋮
X
Q
X_Q
X
Q
​
Y
Q
Y_Q
Y
Q
​
出力
問題文の指示通りに
Q
Q
Q
行出力せよ。
i
i
i
行目には
i
i
i
番目の質問に対する答えを出力せよ。
入力例 1
Copy
Copy
5 5 3
1 2 1
1 2 2
3 4 1
4 5 1
3 5 2
5 3
1 2
3 1
出力例 1
Copy
Copy
-2
inf
nan
1
1
1
番目の質問では、道路
5
5
5
を使って街
5
5
5
から街
3
3
3
に移動すると、ポイントを
−
2
-2
−
2
所持している状態で街
3
3
3
にいることができます。
これ以上ポイントを大きくすることはできないので答えは
−
2
-2
−
2
になります。
2
2
2
番目の質問では、「道路
2
2
2
を使って街
1
1
1
から街
2
2
2
に移動し、道路
1
1
1
を使って街
2
2
2
から街
1
1
1
に移動する」
という行動を好きなだけ繰り返したあと、道路
2
2
2
を使って街
1
1
1
から街
2
2
2
に移動することで、
街
2
2
2
にいる状態で所持しているポイントをいくらでも増やすことができます。
3
3
3
番目の質問では、街
3
3
3
から移動を始めて街
1
1
1
へ到達することはできません。
入力例 2
Copy
Copy
2 1 1
1 1 1
1 1
出力例 2
Copy
Copy
inf
始点と終点が同じ街である道路や、始点と終点が同じ街である質問が含まれることもあります。
入力例 3
Copy
Copy
9 7 5
3 1 4
1 5 9
2 6 5
3 5 8
9 7 9
3 2 3
8 4 6
2 6
4 3
3 8
3 2
7 9
出力例 3
Copy
Copy
inf
nan
nan
inf
-9
Score :
500
500
5
0
0
points
Problem Statement
There are
N
N
N
towns numbered
1
,
…
,
N
1,ldots,N
1
,
…
,
N
and
M
M
M
roads numbered
1
,
…
,
M
1,ldots,M
1
,
…
,
M
.
Road
i
i
i
connects towns
A
i
A_i
A
i
​
and
B
i
B_i
B
i
​
.  When you use a road, your
score
changes as follows:
when you move from town
A
i
A_i
A
i
​
to town
B
i
B_i
B
i
​
using road
i
i
i
, your score increases by
C
i
C_i
C
i
​
; when you move from town
B
i
B_i
B
i
​
to town
A
i
A_i
A
i
​
using road
i
i
i
, your score decreases by
C
i
C_i
C
i
​
.
Your score may become negative.
Answer the following
Q
Q
Q
questions.
If you start traveling from town
X
i
X_i
X
i
​
with initial score
0
0
0
, find the maximum possible score when you are at town
Y
i
Y_i
Y
i
​
.
Here, if you cannot get from town
X
i
X_i
X
i
​
to town
Y
i
Y_i
Y
i
​
, print
nan
instead; if you can have as large a score as you want when you are at town
Y
i
Y_i
Y
i
​
, print
inf
instead.
Constraints
2
≤
N
≤
1
0
5
2leq N leq 10^5
2
≤
N
≤
1
0
5
0
≤
M
≤
1
0
5
0leq M leq 10^5
0
≤
M
≤
1
0
5
1
≤
Q
≤
1
0
5
1leq Q leq 10^5
1
≤
Q
≤
1
0
5
1
≤
A
i
,
B
i
,
X
i
,
Y
i
≤
N
1leq A_i,B_i,X_i,Y_i leq N
1
≤
A
i
​
,
B
i
​
,
X
i
​
,
Y
i
​
≤
N
0
≤
C
i
≤
1
0
9
0leq C_i leq 10^9
0
≤
C
i
​
≤
1
0
9
All values in the input are integers.
Input
The input is given from Standard Input in the following format:
N
N
N
M
M
M
Q
Q
Q
A
1
A_1
A
1
​
B
1
B_1
B
1
​
C
1
C_1
C
1
​
⋮
vdots
⋮
A
M
A_M
A
M
​
B
M
B_M
B
M
​
C
M
C_M
C
M
​
X
1
X_1
X
1
​
Y
1
Y_1
Y
1
​
⋮
vdots
⋮
X
Q
X_Q
X
Q
​
Y
Q
Y_Q
Y
Q
​
Output
Print
Q
Q
Q
lines as specified in the Problem Statement.
The
i
i
i
-th line should contain the answer to the
i
i
i
-th question.
Sample Input 1
Copy
Copy
5 5 3
1 2 1
1 2 2
3 4 1
4 5 1
3 5 2
5 3
1 2
3 1
Sample Output 1
Copy
Copy
-2
inf
nan
For the first question, if you use road
5
5
5
to move from town
5
5
5
to town
3
3
3
, you can have a score
−
2
-2
−
2
when you are at town
3
3
3
.
Since you cannot make the score larger, the answer is
−
2
-2
−
2
.
For the second question, you can have as large a score as you want when you are at town
2
2
2
if you travel as follows:
repeatedly "use road
2
2
2
to move from town
1
1
1
to town
2
2
2
and then use road
1
1
1
to move from town
2
2
2
to town
1
1
1
" as many times as you want,
and finally use road
2
2
2
to move from town
1
1
1
to town
2
2
2
.
For the third question, you cannot get from town
3
3
3
to town
1
1
1
.
Sample Input 2
Copy
Copy
2 1 1
1 1 1
1 1
Sample Output 2
Copy
Copy
inf
The endpoints of a road may be the same, and so may the endpoints given in a question.
Sample Input 3
Copy
Copy
9 7 5
3 1 4
1 5 9
2 6 5
3 5 8
9 7 9
3 2 3
8 4 6
2 6
4 3
3 8
3 2
7 9
Sample Output 3
Copy
Copy
inf
nan
nan
inf
-9
Facebook
Twitter
Hatena
共有
ルール
用語集
利用規約
プライバシーポリシー
個人情報保護方針
企業情報
よくある質問
お問い合わせ
資料請求
Copyright Since 2012 ©
AtCoder Inc.
All rights reserved.
2024-03-19 (火)
18:06:56 +09:00
ページトップ
✓
共有ありがとう
AddToAny
もっと